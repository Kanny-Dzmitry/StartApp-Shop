<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Shop</title>
    <link rel="stylesheet" href="/static/css/telegram-app.css">
    <!-- Telegram WebApp JS SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="container">
        <div id="error-message" class="message error-message"></div>
        <div id="success-message" class="message success-message"></div>
        
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <div class="nav-tabs">
            <div class="nav-tab active" data-tab="profile">–ü—Ä–æ—Ñ–∏–ª—å</div>
            <div class="nav-tab" data-tab="catalog">–ö–∞—Ç–∞–ª–æ–≥</div>
            <div class="nav-tab" data-tab="cart">–ö–æ—Ä–∑–∏–Ω–∞</div>
        </div>
        
        <!-- –°–µ–∫—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è -->
        <div id="profile-container" class="profile-container">
            <!-- –°–µ–∫—Ü–∏—è –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
            <div id="auth-section" class="section" style="display: none;">
                <h2>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h2>
                <p>–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–æ—Ñ–∏–ª—é –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram.</p>
                <p>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p>
            </div>
            
            <!-- –°–µ–∫—Ü–∏—è –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
            <div id="profile-section" class="section" style="display: none;">
                <h2>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h2>
                
                <!-- –†–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
                <div id="view-mode">
                    <div class="profile-header">
                        <img id="profile-avatar" src="/static/img/default-avatar.png" alt="–ê–≤–∞—Ç–∞—Ä" class="profile-avatar">
                        <div>
                            <h3 class="profile-name" id="profile-name">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                            <p class="profile-username" id="profile-username">@username</p>
                        </div>
                    </div>
                    
                    <div id="user-info" class="user-info">
                        <!-- –î–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                    </div>
                    
                    <div id="addresses-container" class="addresses-container">
                        <h3>–ú–æ–∏ –∞–¥—Ä–µ—Å–∞ <span class="address-count" id="address-count">(0/5)</span></h3>
                        <div id="addresses-list" class="addresses-list">
                            <!-- –°–ø–∏—Å–æ–∫ –∞–¥—Ä–µ—Å–æ–≤ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
                        </div>
                        <button id="add-address-btn" class="btn btn-secondary">–î–æ–±–∞–≤–∏—Ç—å –∞–¥—Ä–µ—Å</button>
                    </div>
                    
                    <button id="edit-profile-btn" class="btn btn-block">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
                </div>
                
                <!-- –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è -->
                <div id="edit-mode" style="display: none;">
                    <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è</h3>
                    
                    <form id="profile-edit-form">
                        <div class="form-group">
                            <label for="first-name">–ò–º—è</label>
                            <input type="text" id="first-name" name="first-name" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
                        </div>
                        
                        <div class="form-group">
                            <label for="last-name">–§–∞–º–∏–ª–∏—è</label>
                            <input type="text" id="last-name" name="last-name" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ñ–∞–º–∏–ª–∏—é">
                        </div>
                        
                        <div class="form-group">
                            <label for="phone-number">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                            <input type="tel" id="phone-number" name="phone-number" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞">
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                            <button type="button" id="cancel-edit-btn" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                        </div>
                    </form>
                </div>
                
                <!-- –†–µ–∂–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–¥—Ä–µ—Å–∞ -->
                <div id="address-edit-mode" style="display: none;">
                    <h3 id="address-form-title">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞</h3>
                    
                    <form id="address-edit-form">
                        <input type="hidden" id="address-id" name="address-id" value="">
                        
                        <div class="form-group">
                            <label for="address-name">–ù–∞–∑–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–∞</label>
                            <input type="text" id="address-name" name="address-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –î–æ–º, –†–∞–±–æ—Ç–∞">
                        </div>
                        
                        <div class="location-button-container">
                            <button type="button" id="get-location-btn" class="btn btn-secondary">
                                <span class="location-icon">üìç</span> –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞–¥—Ä–µ—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
                                <span id="location-spinner" class="spinner" style="display: none;"></span>
                            </button>
                        </div>
                        
                        <div class="form-group">
                            <label for="district">–†–∞–π–æ–Ω</label>
                            <input type="text" id="district" name="district" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ä–∞–π–æ–Ω">
                        </div>
                        
                        <div class="form-group">
                            <label for="street">–£–ª–∏—Ü–∞</label>
                            <input type="text" id="street" name="street" placeholder="–í–≤–µ–¥–∏—Ç–µ —É–ª–∏—Ü—É">
                        </div>
                        
                        <div class="form-group">
                            <label for="house-number">–ù–æ–º–µ—Ä –¥–æ–º–∞</label>
                            <input type="text" id="house-number" name="house-number" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –¥–æ–º–∞">
                        </div>
                        
                        <div class="form-group">
                            <label for="floor">–≠—Ç–∞–∂</label>
                            <input type="text" id="floor" name="floor" placeholder="–í–≤–µ–¥–∏—Ç–µ —ç—Ç–∞–∂">
                        </div>
                        
                        <div class="form-group">
                            <label for="apartment">–ö–≤–∞—Ä—Ç–∏—Ä–∞</label>
                            <input type="text" id="apartment" name="apartment" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –∫–≤–∞—Ä—Ç–∏—Ä—ã">
                        </div>
                        
                        <div class="form-group">
                            <label class="checkbox-container">
                                <input type="checkbox" id="is-default" name="is-default">
                                <span class="checkmark"></span>
                                –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –∞–¥—Ä–µ—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                            </label>
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                            <button type="button" id="cancel-address-btn" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- –°–µ–∫—Ü–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞ -->
        <div id="catalog-container" class="catalog-container" style="display: none;">
            <h2>–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</h2>
            <p>–ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤.</p>
        </div>
        
        <!-- –°–µ–∫—Ü–∏—è –∫–æ—Ä–∑–∏–Ω—ã -->
        <div id="cart-container" class="cart-container" style="display: none;">
            <h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
            <p>–ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–æ—Ä–∑–∏–Ω–∞ —Å —Ç–æ–≤–∞—Ä–∞–º–∏.</p>
        </div>
    </div>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
    <script src="/static/js/telegram-auth.js"></script>
    <script src="/static/js/profile.js"></script>
    <script>
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
        document.addEventListener('DOMContentLoaded', () => {
            const tabs = document.querySelectorAll('.nav-tab');
            const containers = {
                'profile': document.getElementById('profile-container'),
                'catalog': document.getElementById('catalog-container'),
                'cart': document.getElementById('cart-container')
            };
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.getAttribute('data-tab');
                    
                    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∫–ª–∞–¥–∫–∏
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
                    Object.keys(containers).forEach(key => {
                        if (key === tabName) {
                            containers[key].style.display = 'block';
                        } else {
                            containers[key].style.display = 'none';
                        }
                    });
                });
            });
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
            if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initDataUnsafe && window.Telegram.WebApp.initDataUnsafe.user) {
                const user = window.Telegram.WebApp.initDataUnsafe.user;
                if (user.photo_url) {
                    document.getElementById('profile-avatar').src = user.photo_url;
                }
                if (user.first_name || user.last_name) {
                    document.getElementById('profile-name').textContent = `${user.first_name || ''} ${user.last_name || ''}`.trim();
                }
                if (user.username) {
                    document.getElementById('profile-username').textContent = `@${user.username}`;
                }
            }
        });
    </script>
</body>
</html> 