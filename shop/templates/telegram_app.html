<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Telegram Shop</title>
    <link rel="stylesheet" href="/static/css/telegram-app.css">
    <link rel="stylesheet" href="/static/css/catalog.css">
    <link rel="stylesheet" href="/static/css/cart.css">
    <link rel="stylesheet" href="/static/css/checkout.css">
    <link rel="stylesheet" href="/static/css/orders.css">
    <!-- Telegram WebApp JS SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã -->
    <script src="/static/js/utils.js"></script>
    <script src="/static/js/catalog.js"></script>
    <script src="/static/js/home.js"></script>
</head>
<body>
    <div class="container">
        <div id="error-message" class="message error-message"></div>
        <div id="success-message" class="message success-message"></div>
        
        <!-- –°–µ–∫—Ü–∏—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
        <div id="home-container" class="home-container">
            
            {% if slides %}
            <!-- –°–ª–∞–π–¥–µ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π/–∞–∫—Ü–∏–π -->
            <div class="news-slider">
                <div class="news-slider-container">
                    {% for slide in slides %}
                    <div class="news-slide" data-slide-id="{{ forloop.counter0 }}">
                        {% if slide.link %}
                        <a href="{{ slide.link }}" class="news-slide-link">
                        {% endif %}
                            <img src="{{ slide.image.url }}" alt="" class="news-slide-image">
                        {% if slide.link %}
                        </a>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
                
                <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è —Å–ª–∞–π–¥–µ—Ä–∞ (—Ç–æ–ª—å–∫–æ —Ç–æ—á–∫–∏) -->
                <div class="news-slider-nav">
                    <div class="news-slider-dots">
                        {% for slide in slides %}
                        <button class="news-slider-dot {% if forloop.first %}active{% endif %}" data-slide-id="{{ forloop.counter0 }}" aria-label="–ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–∞–π–¥—É {{ forloop.counter }}"></button>
                        {% endfor %}
                    </div>
                </div>
            </div>
            {% endif %}
            
            {% if active_poll %}
            <!-- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ü–µ–Ω–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
            <div class="rating-poll-container" id="rating-poll" data-poll-id="{{ active_poll.id }}">
                <h3 class="rating-poll-title">–û–ü–†–û–°</h3>
                <p class="rating-poll-description">
                    {% if active_poll.description %}{{ active_poll.description }}{% else %}{{ active_poll.title }}{% endif %}
                </p>
                
                {% if user_has_voted %}
                <!-- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –≥–æ–ª–æ—Å–æ–≤–∞–ª, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç -->
                <div class="rating-result visible">
                    <div class="rating-result-stars">
                        {% with ''|center:active_poll.get_average_rating|make_list as stars %}
                            {% for _ in stars %}‚òÖ{% endfor %}
                        {% endwith %}
                        {% with ''|center:5|make_list as empty_stars %}
                            {% for _ in empty_stars|slice:active_poll.get_average_rating %}‚òÜ{% endfor %}
                        {% endwith %}
                    </div>
                    <!-- –°–∫—Ä—ã–≤–∞–µ–º —ç—Ç–∏ –±–ª–æ–∫–∏ —á–µ—Ä–µ–∑ CSS -->
                    <div class="rating-result-text">–°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞: {{ active_poll.get_average_rating|floatformat:1 }} –∏–∑ 5</div>
                    <div class="rating-result-count">–í—Å–µ–≥–æ –æ—Ü–µ–Ω–æ–∫: {{ active_poll.get_ratings_count }}</div>
                </div>
                {% else %}
                <!-- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â—ë –Ω–µ –≥–æ–ª–æ—Å–æ–≤–∞–ª, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É -->
                <div class="rating-stars">
                    <span class="rating-star" data-value="1">‚òÜ</span>
                    <span class="rating-star" data-value="2">‚òÜ</span>
                    <span class="rating-star" data-value="3">‚òÜ</span>
                    <span class="rating-star" data-value="4">‚òÜ</span>
                    <span class="rating-star" data-value="5">‚òÜ</span>
                </div>
                
                <div class="rating-comment">
                    <textarea id="rating-comment" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" maxlength="200"></textarea>
                </div>
                
                <button class="rating-submit-btn" id="rating-submit-btn" disabled>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                
                <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
                <div class="rating-result">
                    <div class="rating-result-stars"></div>
                    <div class="rating-result-text"></div>
                    <div class="rating-result-count"></div>
                </div>
                {% endif %}
            </div>
            {% endif %}
            
            {% if shop_info and shop_info.show_on_home %}
            <!-- –ë–ª–æ–∫ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –º–∞–≥–∞–∑–∏–Ω–µ -->
            <div class="shop-info-container">
                <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º -->
                <div class="shop-info-header">
                    {% if shop_info.logo %}
                    <img src="{{ shop_info.logo.url }}" alt="{{ shop_info.title }}" class="shop-logo">
                    {% endif %}
                    <h2 class="shop-title">{{ shop_info.title }}</h2>
                </div>
                
                <!-- –û–ø–∏—Å–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞ -->
                {% if shop_info.description %}
                <div class="shop-description">
                    {{ shop_info.description }}
                </div>
                {% endif %}
                
                <!-- –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                <div class="shop-contacts">
                    {% if shop_info.address %}
                    <div class="contact-item">
                        <div class="contact-icon">üìç</div>
                        <div class="contact-text">{{ shop_info.address }}</div>
                    </div>
                    {% endif %}
                    
                    {% if shop_info.phone %}
                    <div class="contact-item">
                        <div class="contact-icon">üìû</div>
                        <div class="contact-text">{{ shop_info.phone }}</div>
                    </div>
                    {% endif %}
                    
                    {% if shop_info.email %}
                    <div class="contact-item">
                        <div class="contact-icon">‚úâÔ∏è</div>
                        <div class="contact-text">{{ shop_info.email }}</div>
                    </div>
                    {% endif %}
                    
                    {% if shop_info.working_hours %}
                    <div class="contact-item">
                        <div class="contact-icon">üïí</div>
                        <div class="contact-text">{{ shop_info.working_hours }}</div>
                    </div>
                    {% endif %}
                </div>
                
                <!-- –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ -->
                {% if shop_info.telegram or shop_info.whatsapp or shop_info.instagram or shop_info.vk %}
                <div class="shop-social">
                    {% if shop_info.telegram %}
                    <a href="https://t.me/{{ shop_info.telegram }}" class="social-link" target="_blank" rel="noopener" aria-label="Telegram">
                        <span class="social-icon-emoji">üì±</span>
                    </a>
                    {% endif %}
                    
                    {% if shop_info.whatsapp %}
                    <a href="https://wa.me/{{ shop_info.whatsapp }}" class="social-link" target="_blank" rel="noopener" aria-label="WhatsApp">
                        <span class="social-icon-emoji">üí¨</span>
                    </a>
                    {% endif %}
                    
                    {% if shop_info.instagram %}
                    <a href="https://instagram.com/{{ shop_info.instagram }}" class="social-link" target="_blank" rel="noopener" aria-label="Instagram">
                        <span class="social-icon-emoji">üì∑</span>
                    </a>
                    {% endif %}
                    
                    {% if shop_info.vk %}
                    <a href="https://vk.com/{{ shop_info.vk }}" class="social-link" target="_blank" rel="noopener" aria-label="VK">
                        <span class="social-icon-emoji">üåê</span>
                    </a>
                    {% endif %}
                </div>
                {% endif %}
            </div>
            {% endif %}
            
            <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª –≤ –º–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –Ω–∏–∂–µ.</p>
        </div>
        
        <!-- –°–µ–∫—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è -->
        <div id="profile-container" class="profile-container" style="display: none;">
            <!-- –°–µ–∫—Ü–∏—è –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
            <div id="auth-section" class="section" style="display: none;">
                <h2>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h2>
                <p>–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–æ—Ñ–∏–ª—é –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram.</p>
                <p>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p>
            </div>
            
            <!-- –°–µ–∫—Ü–∏—è –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
            <div id="profile-section" class="section" style="display: none;">
                <h2>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h2>
                
                <!-- –†–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
                <div id="view-mode">
                    <div class="profile-header">
                        <img id="profile-avatar" src="/static/img/default-avatar.png" alt="–ê–≤–∞—Ç–∞—Ä" class="profile-avatar">
                        <div class="profile-info">
                            <h3 class="profile-name" id="profile-name">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                            <p class="profile-username" id="profile-username">@username</p>
                        </div>
                        <button id="edit-profile-btn" class="edit-profile-icon" aria-label="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å">
                            <svg width="20" height="20" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19.4 7.34L16.66 4.6A2 2 0 0 0 14 4.53l-9 9a2 2 0 0 0-.57 1.21L4 18.91a1 1 0 0 0 .29.8A1 1 0 0 0 5 20h.09l4.17-.38a2 2 0 0 0 1.21-.57l9-9a1.92 1.92 0 0 0-.07-2.71zM9.08 17.62l-3 .28.27-3L12 9.32l2.7 2.7zM16 10l-2.68-2.68 1.55-1.55L17.58 8.4z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                                <path d="M12 20H20" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    
                    <div id="user-info" class="user-info">
                        <!-- –î–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                    </div>
                    
                    <div id="addresses-container" class="addresses-container">
                        <h3>–ú–æ–∏ –∞–¥—Ä–µ—Å–∞ <span class="address-count" id="address-count">(0/5)</span></h3>
                        <div id="addresses-list" class="addresses-list">
                            <!-- –°–ø–∏—Å–æ–∫ –∞–¥—Ä–µ—Å–æ–≤ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
                        </div>
                        <button id="add-address-btn" class="btn btn-secondary">–î–æ–±–∞–≤–∏—Ç—å –∞–¥—Ä–µ—Å</button>
                    </div>
                    
                    <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–æ–≤ -->
                    <div class="order-history-button-container">
                        <button id="view-orders-btn" class="btn btn-secondary">–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</button>
                    </div>
                </div>
                
                <!-- –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è -->
                <div id="edit-mode" style="display: none;">
                    <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è</h3>
                    
                    <form id="profile-edit-form">
                        <div class="form-group">
                            <label for="first-name">–ò–º—è</label>
                            <input type="text" id="first-name" name="first-name" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
                        </div>
                        
                        <div class="form-group">
                            <label for="last-name">–§–∞–º–∏–ª–∏—è</label>
                            <input type="text" id="last-name" name="last-name" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ñ–∞–º–∏–ª–∏—é">
                        </div>
                        
                        <div class="form-group">
                            <label for="phone-number">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                            <input type="tel" id="phone-number" name="phone-number" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞">
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                            <button type="button" id="cancel-edit-btn" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                        </div>
                    </form>
                </div>
                
                <!-- –†–µ–∂–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–¥—Ä–µ—Å–∞ -->
                <div id="address-edit-mode" style="display: none;">
                    <h3 id="address-form-title">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞</h3>
                    
                    <form id="address-edit-form">
                        <input type="hidden" id="address-id" name="address-id" value="">
                        
                        <div class="form-group">
                            <label for="address-name">–ù–∞–∑–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–∞</label>
                            <input type="text" id="address-name" name="address-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –î–æ–º, –†–∞–±–æ—Ç–∞">
                        </div>
                        
                        <div class="location-button-container">
                            <button type="button" id="get-location-btn" class="btn btn-secondary">
                                <span class="location-icon">üìç</span> –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞–¥—Ä–µ—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
                                <span id="location-spinner" class="spinner" style="display: none;"></span>
                            </button>
                        </div>
                        
                        <div class="form-group">
                            <label for="district">–†–∞–π–æ–Ω</label>
                            <input type="text" id="district" name="district" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ä–∞–π–æ–Ω">
                        </div>
                        
                        <div class="form-group">
                            <label for="street">–£–ª–∏—Ü–∞</label>
                            <input type="text" id="street" name="street" placeholder="–í–≤–µ–¥–∏—Ç–µ —É–ª–∏—Ü—É">
                        </div>
                        
                        <div class="form-group">
                            <label for="house-number">–ù–æ–º–µ—Ä –¥–æ–º–∞</label>
                            <input type="text" id="house-number" name="house-number" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –¥–æ–º–∞">
                        </div>
                        
                        <div class="form-group">
                            <label for="floor">–≠—Ç–∞–∂</label>
                            <input type="text" id="floor" name="floor" placeholder="–í–≤–µ–¥–∏—Ç–µ —ç—Ç–∞–∂">
                        </div>
                        
                        <div class="form-group">
                            <label for="apartment">–ö–≤–∞—Ä—Ç–∏—Ä–∞</label>
                            <input type="text" id="apartment" name="apartment" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –∫–≤–∞—Ä—Ç–∏—Ä—ã">
                        </div>
                        
                        <div class="form-group">
                            <label class="checkbox-container">
                                <input type="checkbox" id="is-default" name="is-default">
                                <span class="checkmark"></span>
                                –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –∞–¥—Ä–µ—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                            </label>
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                            <button type="button" id="cancel-address-btn" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- –°–µ–∫—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–æ–≤ -->
        <div id="orders-container" class="orders-container" style="display: none;">
            <div class="orders-header">
                <button id="back-to-profile-btn" class="back-button">
                    <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ø—Ä–æ—Ñ–∏–ª—å
                </button>
            </div>
            <h2>–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h2>
            <div id="orders-list" class="orders-list">
                <!-- –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </div>
        
        <!-- –°–µ–∫—Ü–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞ -->
        <div id="catalog-container" class="catalog-container" style="display: none;">
            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É -->
            <div id="catalog-navigation" class="catalog-navigation" style="display: none;">
                <button id="back-to-categories">–ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</button>
                <button id="back-to-sections" style="display: none;">–ö —Ä–∞–∑–¥–µ–ª–∞–º</button>
            </div>
            
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –∫–∞—Ç–∞–ª–æ–≥–∞ -->
            <div id="catalog-content" class="catalog-content">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </div>
        
        <!-- –°–µ–∫—Ü–∏—è –∫–æ—Ä–∑–∏–Ω—ã -->
        <div id="cart-container" class="cart-container" style="display: none;">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –∫–æ—Ä–∑–∏–Ω—ã –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
        </div>
        
        <!-- –°–µ–∫—Ü–∏—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ -->
        <div id="checkout-container" class="checkout-container" style="display: none;">
            <div class="checkout-header">
                <button id="back-to-cart-btn" class="back-to-cart">
                    <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–æ—Ä–∑–∏–Ω—É
                </button>
            </div>
            
            <h2 class="checkout-title">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
            
            <div class="checkout-section">
                <h3 class="checkout-section-title">–î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</h3>
                <div id="checkout-user-info" class="user-info">
                    <!-- –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                </div>
            </div>
            
            <div class="checkout-section">
                <h3 class="checkout-section-title">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</h3>
                <div id="checkout-address-section" class="address-section">
                    <div id="checkout-addresses-list" class="checkout-addresses-list">
                        <!-- –°–ø–∏—Å–æ–∫ –∞–¥—Ä–µ—Å–æ–≤ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
                    </div>
                </div>
            </div>
            
            <div class="checkout-section">
                <h3 class="checkout-section-title">–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</h3>
                <div id="checkout-payment-method" class="payment-method-section">
                    <div class="payment-methods">
                        <label class="payment-method-item">
                            <input type="radio" name="payment-method" value="cash" checked>
                            <span class="payment-method-content">
                                <span class="payment-method-icon">üíµ</span>
                                <span class="payment-method-title">–ù–∞–ª–∏—á–Ω—ã–º–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</span>
                            </span>
                        </label>
                        <label class="payment-method-item">
                            <input type="radio" name="payment-method" value="card">
                            <span class="payment-method-content">
                                <span class="payment-method-icon">üí≥</span>
                                <span class="payment-method-title">–ö–∞—Ä—Ç–æ–π –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</span>
                            </span>
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="checkout-section">
                <h3 class="checkout-section-title">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É</h3>
                <div class="order-comment-section">
                    <textarea id="order-comment" class="order-comment-input" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" maxlength="500"></textarea>
                    <div class="comment-counter"><span id="comment-length">0</span>/500</div>
                </div>
            </div>
            
            <div class="checkout-section">
                <h3 class="checkout-section-title">–í–∞—à –∑–∞–∫–∞–∑</h3>
                <div id="checkout-order-summary" class="order-summary">
                    <!-- –¢–æ–≤–∞—Ä—ã –∏ —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                </div>
            </div>
            
            <div class="checkout-actions">
                <button id="complete-order-btn" class="btn-checkout">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
            </div>
        </div>
        
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
        <div class="bottom-nav">
            <div class="nav-button" data-tab="home">
                <svg class="nav-icon" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M9 22V12h6v10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <div class="nav-button" data-tab="catalog">
                <svg class="nav-icon" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M4 9h16M4 14h16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <div class="nav-button" data-tab="cart">
                <svg class="nav-icon" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 22a1 1 0 100-2 1 1 0 000 2zM20 22a1 1 0 100-2 1 1 0 000 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <div class="cart-badge" id="cart-badge">0</div>
            </div>
            <div class="nav-button" data-tab="profile">
                <svg class="nav-icon" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
        </div>
    </div>
    
    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π -->
    <div id="error-message" class="message error-message" style="display: none;"></div>
    <div id="success-message" class="message success-message" style="display: none;"></div>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
    <script src="/static/js/telegram-auth.js"></script>
    <script src="/static/js/profile.js"></script>
    <script src="/static/js/cart.js"></script>
    <script src="/static/js/catalog.js"></script>
    <script src="/static/js/checkout.js"></script>
    <script src="/static/js/orders.js"></script>
    <script>
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
        document.addEventListener('DOMContentLoaded', () => {
            const navButtons = document.querySelectorAll('.nav-button');
            const containers = {
                'home': document.getElementById('home-container'),
                'profile': document.getElementById('profile-container'),
                'catalog': document.getElementById('catalog-container'),
                'cart': document.getElementById('cart-container')
            };
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–æ–≤
            const ordersContainer = document.getElementById('orders-container');
            
            // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω—É—é
            containers['home'].style.display = 'block';
            document.querySelector('.nav-button[data-tab="home"]').classList.add('active');
            
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabName = button.getAttribute('data-tab');
                    
                    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏
                    navButtons.forEach(b => b.classList.remove('active'));
                    button.classList.add('active');
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å–∫—Ä—ã—Ç–∏—è
                    Object.values(containers).forEach(container => {
                        if (container.style.display === 'block') {
                            container.style.opacity = '0';
                            container.style.transform = 'translateY(10px)';
                        }
                    });
                    
                    // –°–∫—Ä—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–æ–≤ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –ª—é–±—É—é –≤–∫–ª–∞–¥–∫—É
                    if (ordersContainer) {
                        ordersContainer.style.display = 'none';
                    }
                    
                    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
                    setTimeout(() => {
                        Object.keys(containers).forEach(key => {
                            if (key === tabName) {
                                containers[key].style.display = 'block';
                                // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø–æ—è–≤–ª–µ–Ω–∏—è
                                setTimeout(() => {
                                    containers[key].style.opacity = '1';
                                    containers[key].style.transform = 'translateY(0)';
                                    
                                    // –ï—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏–ª–∏—Å—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É –∫–æ—Ä–∑–∏–Ω—ã, –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É
                                    if (key === 'cart' && typeof loadCart === 'function') {
                                        loadCart();
                                    }
                                }, 10);
                            } else {
                                containers[key].style.display = 'none';
                            }
                        });
                    }, 200);
                });
            });
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
            if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initDataUnsafe && window.Telegram.WebApp.initDataUnsafe.user) {
                const user = window.Telegram.WebApp.initDataUnsafe.user;
                if (user.photo_url) {
                    document.getElementById('profile-avatar').src = user.photo_url;
                }
                if (user.first_name || user.last_name) {
                    document.getElementById('profile-name').textContent = `${user.first_name || ''} ${user.last_name || ''}`.trim();
                }
                if (user.username) {
                    document.getElementById('profile-username').textContent = `@${user.username}`;
                }
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ
            function updateCartBadge() {
                const cartBadge = document.getElementById('cart-badge');
                // –ü–æ–ª—É—á–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É –∏–∑ localStorage
                const cart = JSON.parse(localStorage.getItem('cart') || '[]');
                const itemCount = cart.reduce((total, item) => total + item.quantity, 0);
                
                if (itemCount > 0) {
                    cartBadge.textContent = itemCount > 99 ? '99+' : itemCount;
                    cartBadge.classList.add('visible');
                } else {
                    cartBadge.textContent = '0';
                    cartBadge.classList.remove('visible');
                }
            }
            
            // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é addNewAddress –∏–∑ profile.js –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            const originalAddNewAddress = window.addNewAddress;
            window.addNewAddress = function() {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∏–∂–Ω—é—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é
                const bottomNav = document.querySelector('.bottom-nav');
                if (bottomNav) {
                    bottomNav.style.display = 'flex';
                }
                
                // –í—ã–∑—ã–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
                if (typeof originalAddNewAddress === 'function') {
                    originalAddNewAddress();
                }
            };
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            updateCartBadge();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –º–µ–Ω—è–µ—Ç—Å—è –∫–æ—Ä–∑–∏–Ω–∞
            window.addEventListener('cart-updated', updateCartBadge);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É –∫–æ—Ä–∑–∏–Ω—ã –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.onEvent('viewportChanged', () => {
                    if (window.Telegram.WebApp.isExpanded) {
                        // –ï—Å–ª–∏ –∫–æ—Ä–∑–∏–Ω–∞ –≤–∏–¥–∏–º–∞, –æ–±–Ω–æ–≤–ª—è–µ–º –µ—ë
                        const cartContainer = document.getElementById('cart-container');
                        if (cartContainer && cartContainer.style.display === 'block' && typeof loadCart === 'function') {
                            loadCart();
                        }
                    }
                });
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç—ã –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫–∏
            document.querySelectorAll('.btn, .nav-button, .address-item').forEach(elem => {
                elem.addEventListener('touchstart', function() {
                    this.style.transform = 'scale(0.98)';
                }, { passive: true });
                
                elem.addEventListener('touchend', function() {
                    this.style.transform = 'scale(1)';
                }, { passive: true });
            });
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–ª–∞–π–¥–µ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π/–∞–∫—Ü–∏–π
            // initNewsSlider(); // –¢–µ–ø–µ—Ä—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ home.js
        });
        
        // –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å–ª–∞–π–¥–µ—Ä–∞ –Ω–æ–≤–æ—Å—Ç–µ–π/–∞–∫—Ü–∏–π - —É–¥–∞–ª–µ–Ω, —Ç–∞–∫ –∫–∞–∫ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω –≤ home.js
    </script>
</body>
</html> 